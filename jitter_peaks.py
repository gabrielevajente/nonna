from nonna_functions import *
import numpy

gps = [[1124022616, 1124038816],
       [1124087416, 1124103616],
       [1124114416, 1124125216],
       [1124128816, 1124145016],
       [1124154916, 1124175616],
       [1124179216, 1124226016],
       [1124245816, 1124249416],
       [1124276416, 1124310616],
       [1124321416, 1124326816],
       [1124350216, 1124386216],
       [1124397052, 1124400616],
       [1124532017, 1124546417],
       [1124614817, 1124640017],
       [1124860337, 1124895617],
       [1124937017, 1124944217],
       [1124973017, 1124978417],
       [1125037817, 1125046817],
       [1125189017, 1125192617],
       [1125196217, 1125201617],
       [1125291617, 1125295217],
       [1125316817, 1125334817]]

for i,g in enumerate(gps):
	print 'Segment %d: %d - %d' % (i, g[0], g[1])
	print 'Read data...'
	d = nonna_get_data_from_disk('H1:CAL-DELTAL_EXTERNAL_DQ', g[0], g[1]-g[0], outfs=1024, verbose=False)
	print 'Compute BLRMS...'
	b = nonna_blrms(d, 300, 400, 1024, 1)
	print 'Saving result'
	numpy.savetxt('blrms_300_400_%d.txt' % (g[0]+10), b)

